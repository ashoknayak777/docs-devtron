"use strict";(self.webpackChunkdocdevtron=self.webpackChunkdocdevtron||[]).push([[29],{1470:(e,n,t)=>{t.d(n,{A:()=>S});var s=t(6540),r=t(4164),i=t(7559),o=t(3104),l=t(6347),a=t(205),c=t(7485),d=t(1682),u=t(679);function h(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,s.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:s}})=>({value:e,label:n,attributes:t,default:s}))}(t);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function x({value:e,tabValues:n}){return n.some(n=>n.value===e)}function j({queryString:e=!1,groupId:n}){const t=(0,l.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(r),(0,s.useCallback)(e=>{if(!r)return;const n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})},[r,t])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,i=p(e),[o,l]=(0,s.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i})),[c,d]=j({queryString:t,groupId:r}),[h,m]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,r]=(0,u.Dv)(n);return[t,(0,s.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:r}),f=(()=>{const e=c??h;return x({value:e,tabValues:i})?e:null})();(0,a.A)(()=>{f&&l(f)},[f]);return{selectedValue:o,selectValue:(0,s.useCallback)(e=>{if(!x({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)},[d,m,i]),tabValues:i}}var f=t(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(4848);function v({className:e,block:n,selectedValue:t,selectValue:s,tabValues:i}){const l=[],{blockElementScrollPositionUntilNextRender:a}=(0,o.a_)(),c=e=>{const n=e.currentTarget,r=l.indexOf(n),o=i[r].value;o!==t&&(a(n),s(o))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:s})=>(0,b.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...s,className:(0,r.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function y({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===t);return e?(0,s.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function w(e){const n=m(e);return(0,b.jsxs)("div",{className:(0,r.A)(i.G.tabs.container,"tabs-container",g.tabList),children:[(0,b.jsx)(v,{...n,...e}),(0,b.jsx)(y,{...n,...e})]})}function S(e){const n=(0,f.A)();return(0,b.jsx)(w,{...e,children:h(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var s=t(6540);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},9108:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"user-guide/finops/configurations","title":"Configurations","description":"The Configurations page lets you manage configurations for Cost Visibility in Devtron. You can:","source":"@site/docs/user-guide/finops/configurations.md","sourceDirName":"user-guide/finops","slug":"/user-guide/finops/configurations","permalink":"/docs/user-guide/finops/configurations","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Cost Breakdown","permalink":"/docs/user-guide/finops/cost-breakdown"},"next":{"title":"Overview","permalink":"/docs/user-guide/security-features"}}');var r=t(4848),i=t(8453),o=t(1470),l=t(9365);const a={},c="Configurations",d={},u=[{value:"Currency (Default)",id:"currency-default",level:2},{value:"Enable Cost Tracking",id:"enable-cost-tracking",level:2},{value:"Step 1: Creating Custom Role",id:"step-1-creating-custom-role",level:4},{value:"Step 2: Create a Service Principal",id:"step-2-create-a-service-principal",level:4},{value:"Step 3: Enter Details in Devtron",id:"step-3-enter-details-in-devtron",level:4},{value:"Step 1: Set up a Spot Instance Data Feed",id:"step-1-set-up-a-spot-instance-data-feed",level:4},{value:"Step 2: Create an IAM Role or Use Access Keys",id:"step-2-create-an-iam-role-or-use-access-keys",level:4},{value:"IAM Role (Recommended)",id:"iam-role-recommended",level:4},{value:"Access Keys (Alternative)",id:"access-keys-alternative",level:4},{value:"Step 3: Configure in Devtron",id:"step-3-configure-in-devtron",level:4},{value:"Fetching Prometheus Endpoint",id:"fetching-prometheus-endpoint",level:2},{value:"Installing Prometheus",id:"installing-prometheus",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configurations",children:"Configurations"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"Configurations"})," page lets you manage configurations for Cost Visibility in Devtron. You can:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Set the default currency for all cost-related data."}),"\n",(0,r.jsx)(n.li,{children:"Enable or disable cost tracking for your connected clusters."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"currency-default",children:"Currency (Default)"}),"\n",(0,r.jsx)(n.p,{children:"You can select your preferred currency as default."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"enable-cost-tracking",children:"Enable Cost Tracking"}),"\n",(0,r.jsx)(n.p,{children:"To enable cost visibility for a cluster, follow the below steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Choose your preferred cluster, and click on ",(0,r.jsx)(n.strong,{children:"Off/Enabled"}),". An ",(0,r.jsx)(n.strong,{children:"Edit Cluster"})," modal window will open."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enable the toggle next to ",(0,r.jsx)(n.strong,{children:"Enable cost tracking"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Select the cloud provider in which you have created your cluster."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Based on the cloud provider you need to do the following configurations:"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(o.A,{children:[(0,r.jsxs)(l.A,{label:"GCP",value:"GCP",children:[(0,r.jsx)(n.p,{children:"To enable cost visibility for Google Cloud in Devtron, you need to generate an API key and use it to connect Devtron with your GCP account."}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Generate the API key using standard ",(0,r.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/api-keys#gcloud",children:"Google Cloud API key documentation"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Now go back to the ",(0,r.jsx)(n.strong,{children:"Edit cluster"})," modal window, and enter the API key in the ",(0,r.jsx)(n.strong,{children:"Cloud Provider API Key"})," field."]}),"\n"]}),"\n"]}),(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsxs)(n.p,{children:["If you face any issues while enabling or configuring the ",(0,r.jsx)(n.strong,{children:"Cost Visibility"})," module, reach out to ",(0,r.jsx)(n.a,{href:"mailto:enterprise@devtron.ai",children:"Devtron Support Team"})," for assistance."]})]})]}),(0,r.jsxs)(l.A,{label:"Azure",value:"Azure",children:[(0,r.jsx)(n.p,{children:"To enable cost visibility for your Azure clusters in Devtron, you need to allow Devtron to access your billing data securely. This requires two steps:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create a custom role in Azure with billing access."}),"\n",(0,r.jsx)(n.li,{children:"Create a service principal (an identity) that Devtron can use to fetch cost details."}),"\n"]}),(0,r.jsx)(n.h4,{id:"step-1-creating-custom-role",children:"Step 1: Creating Custom Role"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Open a text editor and copy the following JSON:"}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Name": "OpenCostRole",\n  "IsCustom": true,\n  "Description": "Rate Card query role",\n  "Actions": [\n      "Microsoft.Compute/virtualMachines/vmSizes/read",\n      "Microsoft.Resources/subscriptions/locations/read",\n      "Microsoft.Resources/providers/read",\n      "Microsoft.ContainerService/containerServices/read",\n      "Microsoft.Commerce/RateCard/read"\n  ],\n  "AssignableScopes": [\n      "/subscriptions/YOUR_SUBSCRIPTION_ID"\n  ]\n}\n'})}),(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:"YOUR_SUBSCRIPTION_ID"})," with your actual subscription ID."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Save the file as ",(0,r.jsx)(n.code,{children:"myrole.json"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run the following command in your terminal:"}),"\n"]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"az role definition create --verbose --role-definition @myrole.json\n"})}),(0,r.jsxs)(n.p,{children:["This creates a role called ",(0,r.jsx)(n.code,{children:"OpenCostRole"})," with just enough access to read pricing information."]}),(0,r.jsx)(n.h4,{id:"step-2-create-a-service-principal",children:"Step 2: Create a Service Principal"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Run the command below, again replacing ",(0,r.jsx)(n.code,{children:"YOUR_SUBSCRIPTION_ID"})," with your subscription ID:"]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'az ad sp create-for-rbac \\\n  --name "OpenCostAccess" \\\n  --role "OpenCostRole" \\\n  --scope "/subscriptions/YOUR_SUBSCRIPTION_ID" \\\n  --output json\n'})}),(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"You\u2019ll get an output like this:"}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n   "appId": "1d9b1532-abe4-4e08-b172-adfa5384da1",\n   "displayName": "OpenCostAccess",\n   "password": "3DZ8Q~KOE.WgdmmRkBHg3dF1rfrpFhSPk.Hnb4-",\n   "tenant": "aee9b2ed-7ecc-4cb2-bfed-60d71c0e957"\n}\n'})}),(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Note this information as you need to enter this in Devtron."}),"\n"]}),(0,r.jsx)(n.h4,{id:"step-3-enter-details-in-devtron",children:"Step 3: Enter Details in Devtron"}),(0,r.jsxs)(n.p,{children:["Now go back to the ",(0,r.jsx)(n.strong,{children:"Edit cluster"})," modal window, and fill the following fields:"]}),(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Field"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Value to Provide"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Subscription ID"}),(0,r.jsx)(n.td,{children:"Your Azure subscription ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"App ID"}),(0,r.jsxs)(n.td,{children:["Value of ",(0,r.jsx)(n.code,{children:"appId"})," from the output"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Display Name"}),(0,r.jsxs)(n.td,{children:["Value of ",(0,r.jsx)(n.code,{children:"displayName"})," from the output"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Password"}),(0,r.jsxs)(n.td,{children:["Value of ",(0,r.jsx)(n.code,{children:"password"})," from the output"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Tenant"}),(0,r.jsxs)(n.td,{children:["Value of ",(0,r.jsx)(n.code,{children:"tenant"})," from the output"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Billing Account"}),(0,r.jsx)(n.td,{children:"Optional (fill if available)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Offer ID"}),(0,r.jsx)(n.td,{children:"Optional (fill if available)"})]})]})]}),(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsxs)(n.p,{children:["If you face any issues while enabling or configuring the ",(0,r.jsx)(n.strong,{children:"Cost Visibility"})," module, reach out to ",(0,r.jsx)(n.a,{href:"mailto:enterprise@devtron.ai",children:"Devtron Support Team"})," for assistance."]})]})]}),(0,r.jsxs)(l.A,{label:"AWS",value:"AWS",children:[(0,r.jsx)(n.p,{children:"If you have spot node instances in your AWS cluster, then only you need to do the below additional configurations for your AWS cluster, else you can skip the below configurations"}),(0,r.jsx)(n.h4,{id:"step-1-set-up-a-spot-instance-data-feed",children:"Step 1: Set up a Spot Instance Data Feed"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create an S3 bucket"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Assign full access permissions to the AWS Spot Data Feed service"}),"\n"]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Principal": {\n        "Service": "spot.amazonaws.com"\n      },\n      "Action": "*",\n      "Resource": "arn:aws:s3:::devtron-spot-feed/*"\n    },\n    {\n      "Effect": "Allow",\n      "Principal": {\n        "Service": "spot.amazonaws.com"\n      },\n      "Action": "*",\n      "Resource": "arn:aws:s3:::devtron-spot-feed"\n    }\n  ]\n}\n'})}),(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Run the following command to subscribe to the data feed using the AWS CLI"}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws ec2 create-spot-datafeed-subscription \\\n  --bucket devtron-spot-feed --prefix cost\n"})}),(0,r.jsx)(n.admonition,{title:"Note",type:"warning",children:(0,r.jsx)(n.p,{children:"You can subscribe to the Spot Data Feed for only one S3 bucket at a time. Running the command again updates the feed to the latest bucket."})}),(0,r.jsx)(n.h4,{id:"step-2-create-an-iam-role-or-use-access-keys",children:"Step 2: Create an IAM Role or Use Access Keys"}),(0,r.jsx)(n.p,{children:"You can connect Devtron to AWS cost data using either of the following methods:"}),(0,r.jsx)(n.h4,{id:"iam-role-recommended",children:"IAM Role (Recommended)"}),(0,r.jsx)(n.p,{children:"Create a Web Identity IAM role for your EKS/EC2 cluster with permissions to access the Spot Data Feed bucket. Attach the following policy (replace CHANGE-ME with your bucket name)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Action": [\n        "s3:ListAllMyBuckets",\n        "s3:ListBucket",\n        "s3:Get*"\n      ],\n      "Resource": [\n        "arn:aws:s3:::CHANGE-ME",\n        "arn:aws:s3:::CHANGE-ME/*"\n      ],\n      "Effect": "Allow"\n    }\n  ]\n}\n\n'})}),(0,r.jsx)(n.h4,{id:"access-keys-alternative",children:"Access Keys (Alternative)"}),(0,r.jsxs)(n.p,{children:["Provide an Access Key and Secret Key with permissions ",(0,r.jsx)(n.code,{children:"s3:ListBucket"})," and ",(0,r.jsx)(n.code,{children:"s3:GetObject"})," for the Spot Data Feed bucket."]}),(0,r.jsx)(n.h4,{id:"step-3-configure-in-devtron",children:"Step 3: Configure in Devtron"}),(0,r.jsxs)(n.p,{children:["Now go back to the ",(0,r.jsx)(n.strong,{children:"Edit cluster"})," modal window, and fill the following fields:"]}),(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Field"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Description"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Spot Data Bucket"}),(0,r.jsx)(n.td,{children:"Name of the S3 bucket storing Spot Instance Data Feed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Spot Data Region"}),(0,r.jsx)(n.td,{children:"AWS region of the Spot Data Feed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Spot Data Prefix"}),(0,r.jsx)(n.td,{children:"Prefix (if any) used for the Spot Data Feed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Project ID"}),(0,r.jsx)(n.td,{children:"Your AWS Account ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Access Key"}),(0,r.jsx)(n.td,{children:"(Optional) AWS Access Key with S3 read permissions"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Secret Access Key"}),(0,r.jsx)(n.td,{children:"(Optional) AWS Secret Access Key with S3 read permissions"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IAM Role"}),(0,r.jsx)(n.td,{children:"(Recommended) IAM role ARN assigned to the EKS/EC2 cluster for bucket access"})]})]})]})]})]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:["Enter Prometheus endpoint of your cluster. Refer ",(0,r.jsx)(n.a,{href:"#fetching-prometheus-endpoint",children:"Fetching Prometheus Endpoint"})," to learn more."]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsx)(n.p,{children:"Prometheus endpoint should be publicly exposed for the cost visibility to work."})]}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"}),", cost visibility will be enabled for the cluster."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"info",children:(0,r.jsx)(n.p,{children:"After enabling cost visibility, you will see your cluster information after 1 hour in cost visibility module."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"fetching-prometheus-endpoint",children:"Fetching Prometheus Endpoint"}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"warning",children:(0,r.jsxs)(n.p,{children:["Ensure ",(0,r.jsx)(n.a,{href:"/docs/user-guide/global-configurations/gitops",children:"GitOps"})," is configured before deploying Prometheus. If not, Prometheus will default to being deployed via Helm."]})}),"\n",(0,r.jsx)(n.h3,{id:"installing-prometheus",children:"Installing Prometheus"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to the ",(0,r.jsx)(n.strong,{children:"Chart Store"})," and search for ",(0,r.jsx)(n.code,{children:"prometheus"}),". Use the Prometheus community's ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," chart to deploy Prometheus."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app2.jpg",alt:"Figure 1: Chart Store"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"After selecting the chart, configure these values as needed before deployment."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kube-state-metrics: \n    metricLabelsAllowlist:   \n    - pods=[*]\n"})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"serviceMonitorSelectorNilUsesHelmValues: false\npodMonitorSelectorNilUsesHelmValues: false\n"})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"Search for the above parameters, and update them as shown (or customize as needed)."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app3.jpg",alt:"Figure 2a: Prometheus Chart Configuration"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app-metrics-config.jpg",alt:"Figure 2b: Prometheus Chart Configuration (cont.)"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enable ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter to install CRDs:"]}),"\n",(0,r.jsxs)(n.p,{children:["Since Helm does not automatically apply CRDs, you need to enable the ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter in the Helm chart to ensure CRDs are applied before deploying Prometheus."]}),"\n",(0,r.jsxs)(n.p,{children:["In the Prometheus Helm chart settings, locate the ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter and set it to ",(0,r.jsx)(n.code,{children:"true"})," if it is ",(0,r.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app-new2.jpg",alt:"Figure 3: upgradeJob Parameter"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["After enabling the parameter, click ",(0,r.jsx)(n.strong,{children:"Deploy Chart"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{title:"Common Pitfall: Prometheus Deployment Timeout due to Failed CRDs",type:"warning",children:[(0,r.jsxs)(n.p,{children:["While deploying ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," chart, the deployment status may show as ",(0,r.jsx)(n.strong,{children:"Timed out"}),", and some CustomResourceDefinitions (CRDs) may appear as ",(0,r.jsx)(n.strong,{children:"Failed"}),"."]}),(0,r.jsxs)(n.p,{children:["To solve it, refer ",(0,r.jsx)(n.a,{href:"/docs/user-guide/creating-application/app-metrics#troubleshoot-issues",children:"Troubleshoot Issues"})]})]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"After the chart deployed successfully, you need to make the Prometheus endpoint exposed publicly."}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsxs)(n.p,{children:["If you face any issues while enabling or configuring the ",(0,r.jsx)(n.strong,{children:"Cost Visibility"})," module, please contact the ",(0,r.jsx)(n.a,{href:"mailto:support@devtron.ai",children:"Devtron Support Team"})," for assistance."]})]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>o});t(6540);var s=t(4164);const r={tabItem:"tabItem_Ymn6"};var i=t(4848);function o({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,s.A)(r.tabItem,t),hidden:n,children:e})}}}]);